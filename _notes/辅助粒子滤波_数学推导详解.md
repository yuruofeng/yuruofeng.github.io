---
title: "è¾…åŠ©ç²’å­æ»¤æ³¢ï¼šæ•°å­¦ç†è®ºä¸æ¨å¯¼è¯¦è§£"
date: 2025-02-07
category: "Mathematics / Statistics"
icon: "ğŸ“ˆ"
description: "è¾…åŠ©ç²’å­æ»¤æ³¢ï¼ˆAuxiliary Particle Filter, APFï¼‰ç”±Pittä¸Shephardäº1999å¹´åœ¨ã€Šç¾å›½ç»Ÿè®¡åä¼šæ‚å¿—ã€‹ï¼ˆJASAï¼‰ä¸Šå‘è¡¨çš„å¼€åˆ›æ€§è®ºæ–‡ä¸­é¦–æ¬¡æå‡ºï¼Œè¯¥æ–¹æ³•é€šè¿‡åœ¨é‡é‡‡æ ·å‰å¼•å…¥è§‚æµ‹ä¿¡æ¯çš„'å‰ç»'æœºåˆ¶ï¼Œä»æ ¹æœ¬ä¸Šé©æ–°äº†åºè´¯è’™ç‰¹å¡ç½—æ–¹æ³•ã€‚"
tags: ["Statistics", "Filtering", "Mathematics"]
math: true
---

# è¾…åŠ©ç²’å­æ»¤æ³¢ï¼šæ•°å­¦ç†è®ºä¸æ¨å¯¼è¯¦è§£

**è¾…åŠ©ç²’å­æ»¤æ³¢ï¼ˆAuxiliary Particle Filter, APFï¼‰ç”±Pittä¸Shephardäº1999å¹´åœ¨ã€Šç¾å›½ç»Ÿè®¡åä¼šæ‚å¿—ã€‹ï¼ˆJASAï¼‰ä¸Šå‘è¡¨çš„å¼€åˆ›æ€§è®ºæ–‡ä¸­é¦–æ¬¡æå‡ºï¼Œè¯¥æ–¹æ³•é€šè¿‡åœ¨é‡é‡‡æ ·å‰å¼•å…¥è§‚æµ‹ä¿¡æ¯çš„"å‰ç»"æœºåˆ¶ï¼Œä»æ ¹æœ¬ä¸Šé©æ–°äº†åºè´¯è’™ç‰¹å¡ç½—æ–¹æ³•ã€‚** æœ¬æ–‡æ—¨åœ¨æä¾›è¾…åŠ©ç²’å­æ»¤æ³¢å®Œæ•´çš„æ•°å­¦ç†è®ºæ¡†æ¶ä¸ä¸¥æ ¼æ¨å¯¼ã€‚

---

## ä¸€ã€çŠ¶æ€ç©ºé—´æ¨¡å‹çš„æ•°å­¦å½¢å¼åŒ–

### 1.1 åŸºæœ¬å®šä¹‰

**å®šä¹‰ 1.1ï¼ˆçŠ¶æ€ç©ºé—´æ¨¡å‹ï¼‰** è®¾ $(\Omega, \mathcal{F}, \mathbb{P})$ ä¸ºæ¦‚ç‡ç©ºé—´ã€‚çŠ¶æ€ç©ºé—´éšé©¬å°”å¯å¤«æ¨¡å‹ç”±ä»¥ä¸‹éšæœºè¿‡ç¨‹ç»„æˆï¼š

è®¾çŠ¶æ€ç©ºé—´ $\mathcal{X} \subseteq \mathbb{R}^{d_x}$ï¼Œè§‚æµ‹ç©ºé—´ $\mathcal{Y} \subseteq \mathbb{R}^{d_y}$ã€‚å®šä¹‰ï¼š

**çŠ¶æ€è¿‡ç¨‹** $\{X_t\}_{t \geq 0}$ï¼šå–å€¼äº $\mathcal{X}$ çš„é©¬å°”å¯å¤«é“¾ï¼Œæ»¡è¶³é©¬å°”å¯å¤«æ€§è´¨ï¼š

$$\mathbb{P}(X_t \in A | X_{0:t-1}) = \mathbb{P}(X_t \in A | X_{t-1}), \quad \forall A \in \mathcal{B}(\mathcal{X})$$

**è§‚æµ‹è¿‡ç¨‹** $\{Y_t\}_{t \geq 1}$ï¼šå–å€¼äº $\mathcal{Y}$ï¼Œç»™å®šçŠ¶æ€åºåˆ—æ¡ä»¶ç‹¬ç«‹ï¼š

$$\mathbb{P}(Y_{1:n} \in B | X_{0:n}) = \prod_{t=1}^{n} \mathbb{P}(Y_t \in B_t | X_t), \quad \forall B = B_1 \times \cdots \times B_n \in \mathcal{B}(\mathcal{Y}^n)$$

### 1.2 æ¨¡å‹çš„æ¦‚ç‡å¯†åº¦è¡¨ç¤º

å‡è®¾æ‰€æœ‰åˆ†å¸ƒå…³äºé€‚å½“çš„æ”¯é…æµ‹åº¦ï¼ˆLebesgueæµ‹åº¦æˆ–è®¡æ•°æµ‹åº¦ï¼‰ç»å¯¹è¿ç»­ï¼Œåˆ™æ¨¡å‹å¯ç”±ä»¥ä¸‹å¯†åº¦å‡½æ•°åˆ»ç”»ï¼š

**åˆå§‹åˆ†å¸ƒå¯†åº¦ï¼š** $\mu(x_0) := p(x_0)$

**è½¬ç§»å¯†åº¦ï¼ˆçŠ¶æ€è½¬ç§»æ ¸ï¼‰ï¼š** $f(x_t | x_{t-1}) := p(x_t | x_{t-1})$

**è§‚æµ‹ä¼¼ç„¶å¯†åº¦ï¼š** $g(y_t | x_t) := p(y_t | x_t)$

æ¨¡å‹çš„è”åˆå¯†åº¦å¯åˆ†è§£ä¸ºï¼š

$$p(x_{0:n}, y_{1:n}) = \mu(x_0) \prod_{t=1}^{n} f(x_t | x_{t-1}) \prod_{t=1}^{n} g(y_t | x_t)$$

### 1.3 æ»¤æ³¢é—®é¢˜çš„ä¸¥æ ¼å®šä¹‰

**å®šä¹‰ 1.2ï¼ˆæ»¤æ³¢åˆ†å¸ƒï¼‰** ç»™å®šè§‚æµ‹åºåˆ— $y_{1:t} = (y_1, \ldots, y_t)$ï¼Œæ»¤æ³¢åˆ†å¸ƒå®šä¹‰ä¸ºæ¡ä»¶åˆ†å¸ƒï¼š

$$\pi_t(dx_t) := \mathbb{P}(X_t \in dx_t | Y_{1:t} = y_{1:t})$$

å…¶å¯†åº¦å‡½æ•°ï¼ˆè‹¥å­˜åœ¨ï¼‰è®°ä¸º $\pi_t(x_t) := p(x_t | y_{1:t})$ã€‚

**å®šä¹‰ 1.3ï¼ˆé¢„æµ‹åˆ†å¸ƒï¼‰** ä¸€æ­¥é¢„æµ‹åˆ†å¸ƒå®šä¹‰ä¸ºï¼š

$$\pi_{t|t-1}(dx_t) := \mathbb{P}(X_t \in dx_t | Y_{1:t-1} = y_{1:t-1})$$

---

## äºŒã€é€’å½’è´å¶æ–¯æ»¤æ³¢çš„ç†è®ºåŸºç¡€

### 2.1 é¢„æµ‹æ­¥éª¤çš„æ•°å­¦æ¨å¯¼

**å®šç† 2.1ï¼ˆChapman-Kolmogorové¢„æµ‹æ–¹ç¨‹ï¼‰** è®¾ $\pi_{t-1}(x_{t-1})$ ä¸ºæ—¶åˆ» $t-1$ çš„æ»¤æ³¢å¯†åº¦ï¼Œåˆ™é¢„æµ‹å¯†åº¦æ»¡è¶³ï¼š

$$\pi_{t|t-1}(x_t) = \int_{\mathcal{X}} f(x_t | x_{t-1}) \, \pi_{t-1}(x_{t-1}) \, dx_{t-1}$$

**è¯æ˜ï¼š** åº”ç”¨å…¨æ¦‚ç‡å…¬å¼ä¸é©¬å°”å¯å¤«æ€§è´¨ï¼š

$$\begin{aligned}
\pi_{t|t-1}(x_t) &= p(x_t | y_{1:t-1}) \\
&= \int_{\mathcal{X}} p(x_t, x_{t-1} | y_{1:t-1}) \, dx_{t-1} \\
&= \int_{\mathcal{X}} p(x_t | x_{t-1}, y_{1:t-1}) \, p(x_{t-1} | y_{1:t-1}) \, dx_{t-1} \\
&= \int_{\mathcal{X}} p(x_t | x_{t-1}) \, \pi_{t-1}(x_{t-1}) \, dx_{t-1}
\end{aligned}$$

ç¬¬å››ä¸ªç­‰å·åˆ©ç”¨äº†é©¬å°”å¯å¤«æ€§è´¨ï¼š$p(x_t | x_{t-1}, y_{1:t-1}) = p(x_t | x_{t-1})$ã€‚ $\square$

**æ³¨è®°ï¼š** ä¸Šè¿°ç§¯åˆ†å¯ç”¨Lebesgue-Stieltjesç§¯åˆ†å½¢å¼è¡¨ç¤ºä¸ºï¼š

$$\pi_{t|t-1}(x_t) = \int_{\mathcal{X}} f(x_t | x_{t-1}) \, d\Pi_{t-1}(x_{t-1})$$

å…¶ä¸­ $\Pi_{t-1}$ ä¸ºæ»¤æ³¢åˆ†å¸ƒçš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ã€‚

### 2.2 æ›´æ–°æ­¥éª¤çš„æ•°å­¦æ¨å¯¼

**å®šç† 2.2ï¼ˆè´å¶æ–¯æ›´æ–°æ–¹ç¨‹ï¼‰** ç»™å®šæ–°è§‚æµ‹ $y_t$ï¼Œæ»¤æ³¢å¯†åº¦æ»¡è¶³ï¼š

$$\pi_t(x_t) = \frac{g(y_t | x_t) \, \pi_{t|t-1}(x_t)}{\int_{\mathcal{X}} g(y_t | x_t') \, \pi_{t|t-1}(x_t') \, dx_t'}$$

**è¯æ˜ï¼š** ç›´æ¥åº”ç”¨è´å¶æ–¯å®šç†ï¼š

$$\begin{aligned}
\pi_t(x_t) &= p(x_t | y_{1:t}) = p(x_t | y_t, y_{1:t-1}) \\
&= \frac{p(y_t | x_t, y_{1:t-1}) \, p(x_t | y_{1:t-1})}{p(y_t | y_{1:t-1})} \\
&= \frac{p(y_t | x_t) \, \pi_{t|t-1}(x_t)}{p(y_t | y_{1:t-1})}
\end{aligned}$$

å…¶ä¸­ç¬¬ä¸‰ä¸ªç­‰å·åˆ©ç”¨äº†è§‚æµ‹çš„æ¡ä»¶ç‹¬ç«‹æ€§ï¼š$p(y_t | x_t, y_{1:t-1}) = p(y_t | x_t)$ã€‚

å½’ä¸€åŒ–å¸¸æ•°ï¼ˆè¾¹ç¼˜ä¼¼ç„¶/è¯æ®ï¼‰ä¸ºï¼š

$$p(y_t | y_{1:t-1}) = \int_{\mathcal{X}} g(y_t | x_t) \, \pi_{t|t-1}(x_t) \, dx_t$$  $\square$

### 2.3 é€’å½’æ»¤æ³¢æ–¹ç¨‹çš„ç´§å‡‘å½¢å¼

**å®šç† 2.3ï¼ˆæœ€ä¼˜æ»¤æ³¢é€’å½’ï¼‰** ç»“åˆé¢„æµ‹ä¸æ›´æ–°ï¼Œæ»¤æ³¢å¯†åº¦æ»¡è¶³é€’å½’å…³ç³»ï¼š

$$\pi_t(x_t) = \frac{g(y_t | x_t) \int_{\mathcal{X}} f(x_t | x_{t-1}) \, \pi_{t-1}(x_{t-1}) \, dx_{t-1}}{\int_{\mathcal{X}} g(y_t | x_t') \int_{\mathcal{X}} f(x_t' | x_{t-1}) \, \pi_{t-1}(x_{t-1}) \, dx_{t-1} \, dx_t'}$$

æˆ–ç­‰ä»·åœ°å†™ä¸ºæ¯”ä¾‹å½¢å¼ï¼š

$$\pi_t(x_t) \propto g(y_t | x_t) \int_{\mathcal{X}} f(x_t | x_{t-1}) \, d\Pi_{t-1}(x_{t-1})$$

**æ³¨è®°ï¼š** å¯¹äºä¸€èˆ¬éçº¿æ€§éé«˜æ–¯ç³»ç»Ÿï¼Œä¸Šè¿°ç§¯åˆ†æ— è§£æè§£ï¼Œè¿™æ„æˆäº†ç²’å­æ»¤æ³¢æ–¹æ³•çš„ç†è®ºåŸºç¡€ã€‚

---

## ä¸‰ã€é‡è¦æ€§é‡‡æ ·çš„æ•°å­¦ç†è®º

### 3.1 é‡è¦æ€§é‡‡æ ·åŸºæœ¬åŸç†

**å®šä¹‰ 3.1ï¼ˆé‡è¦æ€§é‡‡æ ·ï¼‰** è®¾ç›®æ ‡åˆ†å¸ƒå¯†åº¦ä¸º $\pi(x)$ï¼Œæè®®åˆ†å¸ƒå¯†åº¦ä¸º $q(x)$ï¼Œä¸” $\text{supp}(\pi) \subseteq \text{supp}(q)$ã€‚å¯¹äºå¯ç§¯å‡½æ•° $\varphi: \mathcal{X} \to \mathbb{R}$ï¼ŒæœŸæœ›å€¼å¯è¡¨ç¤ºä¸ºï¼š

$$\mathbb{E}_\pi[\varphi(X)] = \int \varphi(x) \pi(x) dx = \int \varphi(x) \frac{\pi(x)}{q(x)} q(x) dx = \mathbb{E}_q\left[\varphi(X) \cdot w(X)\right]$$

å…¶ä¸­ **éå½’ä¸€åŒ–é‡è¦æ€§æƒé‡** å®šä¹‰ä¸ºï¼š

$$w(x) := \frac{\pi(x)}{q(x)}$$

**å®šç† 3.1ï¼ˆé‡è¦æ€§é‡‡æ ·ä¼°è®¡é‡ï¼‰** è®¾ $\{X^i\}_{i=1}^N \stackrel{i.i.d.}{\sim} q(x)$ï¼Œåˆ™ï¼š

**éå½’ä¸€åŒ–ä¼°è®¡é‡ï¼š** è‹¥ $\pi(x)$ å·²çŸ¥è‡³å½’ä¸€åŒ–å¸¸æ•°ï¼Œå³ $\pi(x) = \tilde{\pi}(x)/Z$ï¼Œåˆ™ï¼š

$$\hat{\varphi}_N^{\text{IS}} = \frac{1}{N} \sum_{i=1}^N \varphi(X^i) \tilde{w}(X^i), \quad \tilde{w}(x) = \frac{\tilde{\pi}(x)}{q(x)}$$

ä¸º $Z \cdot \mathbb{E}_\pi[\varphi]$ çš„æ— åä¼°è®¡é‡ã€‚

**è‡ªå½’ä¸€åŒ–ä¼°è®¡é‡ï¼š** 

$$\hat{\varphi}_N^{\text{SIS}} = \frac{\sum_{i=1}^N \varphi(X^i) \tilde{w}(X^i)}{\sum_{i=1}^N \tilde{w}(X^i)} = \sum_{i=1}^N \varphi(X^i) W^i$$

å…¶ä¸­å½’ä¸€åŒ–æƒé‡ $W^i = \tilde{w}(X^i) / \sum_{j=1}^N \tilde{w}(X^j)$ã€‚

**æ³¨è®°ï¼š** è‡ªå½’ä¸€åŒ–ä¼°è®¡é‡æœ‰åä½†æ¸è¿‘æ— åï¼Œä¸”é€šå¸¸å…·æœ‰æ›´ä½æ–¹å·®ã€‚

### 3.2 æœ‰æ•ˆæ ·æœ¬é‡ä¸æƒé‡é€€åŒ–

**å®šä¹‰ 3.2ï¼ˆæœ‰æ•ˆæ ·æœ¬é‡ï¼‰** æœ‰æ•ˆæ ·æœ¬é‡ï¼ˆESSï¼‰å®šä¹‰ä¸ºï¼š

$$N_{\text{eff}} := \frac{1}{\sum_{i=1}^N (W^i)^2} = \frac{\left(\sum_{i=1}^N w^i\right)^2}{\sum_{i=1}^N (w^i)^2}$$

**æ€§è´¨ï¼š** $1 \leq N_{\text{eff}} \leq N$ï¼Œå…¶ä¸­ï¼š
- $N_{\text{eff}} = 1$ å½“ä¸”ä»…å½“æŸä¸ª $W^i = 1$ï¼ˆå®Œå…¨é€€åŒ–ï¼‰
- $N_{\text{eff}} = N$ å½“ä¸”ä»…å½“æ‰€æœ‰ $W^i = 1/N$ï¼ˆå‡åŒ€æƒé‡ï¼‰

**å®šç† 3.2ï¼ˆæƒé‡é€€åŒ–ï¼‰** åœ¨åºè´¯é‡è¦æ€§é‡‡æ ·ä¸­ï¼Œè®¾å„æ—¶åˆ»æƒé‡ç‹¬ç«‹åŒåˆ†å¸ƒä¸”å…·æœ‰æœ‰é™æ–¹å·®ã€‚åˆ™æƒé‡çš„å˜å¼‚ç³»æ•°éšæ—¶é—´æŒ‡æ•°å¢é•¿ï¼š

$$\text{CV}^2(w_t) := \frac{\text{Var}(w_t)}{[\mathbb{E}(w_t)]^2} = O(e^{ct})$$

å…¶ä¸­ $c > 0$ ä¸ºæŸå¸¸æ•°ã€‚

---

## å››ã€åºè´¯é‡è¦æ€§é‡‡æ ·ä¸é‡é‡‡æ ·

### 4.1 åºè´¯é‡è¦æ€§é‡‡æ ·çš„æƒé‡é€’æ¨

**å®šç† 4.1ï¼ˆSISæƒé‡é€’æ¨å…¬å¼ï¼‰** è®¾æè®®åˆ†å¸ƒå…·æœ‰åˆ†è§£å½¢å¼ï¼š

$$q(x_{0:t} | y_{1:t}) = q(x_0 | y_1) \prod_{s=1}^{t} q(x_s | x_{0:s-1}, y_{1:s})$$

åˆ™é‡è¦æ€§æƒé‡å¯é€’æ¨è®¡ç®—ã€‚å®šä¹‰éå½’ä¸€åŒ–æƒé‡ï¼š

$$\tilde{w}_t := \frac{p(x_{0:t} | y_{1:t})}{q(x_{0:t} | y_{1:t})} \propto \frac{p(x_{0:t}, y_{1:t})}{q(x_{0:t} | y_{1:t})}$$

**æ¨å¯¼ï¼š** 

$$\begin{aligned}
\tilde{w}_t &\propto \frac{\mu(x_0) \prod_{s=1}^{t} f(x_s | x_{s-1}) \prod_{s=1}^{t} g(y_s | x_s)}{q(x_0 | y_1) \prod_{s=1}^{t} q(x_s | x_{0:s-1}, y_{1:s})} \\
&= \tilde{w}_{t-1} \cdot \frac{f(x_t | x_{t-1}) \, g(y_t | x_t)}{q(x_t | x_{0:t-1}, y_{1:t})}
\end{aligned}$$

å®šä¹‰**å¢é‡æƒé‡**ï¼š

$$\alpha_t(x_{t-1}, x_t) := \frac{f(x_t | x_{t-1}) \, g(y_t | x_t)}{q(x_t | x_{0:t-1}, y_{1:t})}$$

åˆ™æœ‰é€’æ¨å…³ç³»ï¼š$\tilde{w}_t = \tilde{w}_{t-1} \cdot \alpha_t$ã€‚

### 4.2 Bootstrapæ»¤æ³¢å™¨çš„ç‰¹æ®Šæƒ…å½¢

**å®šä¹‰ 4.1ï¼ˆBootstrapæè®®åˆ†å¸ƒï¼‰** ä»¤ $q(x_t | x_{t-1}, y_t) = f(x_t | x_{t-1})$ï¼Œå³ä»¥è½¬ç§»å…ˆéªŒä¸ºæè®®åˆ†å¸ƒã€‚

**æ¨è®º 4.1** åœ¨Bootstrapæè®®ä¸‹ï¼Œå¢é‡æƒé‡ç®€åŒ–ä¸ºï¼š

$$\alpha_t = \frac{f(x_t | x_{t-1}) \, g(y_t | x_t)}{f(x_t | x_{t-1})} = g(y_t | x_t)$$

å› æ­¤æƒé‡æ›´æ–°ä¸ºï¼š$\tilde{w}_t = \tilde{w}_{t-1} \cdot g(y_t | x_t)$ã€‚

### 4.3 é‡é‡‡æ ·çš„æ•°å­¦æè¿°

**å®šä¹‰ 4.2ï¼ˆå¤šé¡¹å¼é‡é‡‡æ ·ï¼‰** ç»™å®šåŠ æƒç²’å­é›† $\{(X^i, W^i)\}_{i=1}^N$ï¼Œå¤šé¡¹å¼é‡é‡‡æ ·ç”Ÿæˆæ–°ç²’å­é›† $\{\tilde{X}^i\}_{i=1}^N$ï¼Œå…¶ä¸­ï¼š

$$\tilde{X}^i \stackrel{i.i.d.}{\sim} \sum_{j=1}^N W^j \delta_{X^j}(\cdot)$$

ç­‰ä»·åœ°ï¼Œ$\mathbb{P}(\tilde{X}^i = X^j) = W^j$ã€‚

**å®šç† 4.2ï¼ˆé‡é‡‡æ ·çš„æ— åæ€§ï¼‰** è®¾ $\varphi: \mathcal{X} \to \mathbb{R}$ ä¸ºå¯æµ‹å‡½æ•°ï¼Œ$N^j$ ä¸ºç²’å­ $X^j$ è¢«é€‰ä¸­çš„æ¬¡æ•°ã€‚åˆ™ï¼š

$$\mathbb{E}\left[\frac{1}{N} \sum_{i=1}^N \varphi(\tilde{X}^i) \Big| \{X^j, W^j\}_{j=1}^N\right] = \sum_{j=1}^N W^j \varphi(X^j)$$

**è¯æ˜ï¼š** ç”±äº $\sum_{i=1}^N \varphi(\tilde{X}^i) = \sum_{j=1}^N N^j \varphi(X^j)$ï¼Œä¸” $\mathbb{E}[N^j | \{X^k, W^k\}] = N \cdot W^j$ï¼Œæ•…ï¼š

$$\mathbb{E}\left[\frac{1}{N} \sum_{j=1}^N N^j \varphi(X^j)\right] = \frac{1}{N} \sum_{j=1}^N N W^j \varphi(X^j) = \sum_{j=1}^N W^j \varphi(X^j)$$ $\square$

### 4.4 ç³»ç»Ÿé‡é‡‡æ ·ç®—æ³•

**ç®—æ³•ï¼ˆç³»ç»Ÿé‡é‡‡æ ·ï¼‰ï¼š**

è¾“å…¥ï¼šå½’ä¸€åŒ–æƒé‡ $\{W^i\}_{i=1}^N$ï¼Œå…¶ä¸­ $\sum_{i=1}^N W^i = 1$

1. è®¡ç®—ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼š$C^0 = 0$ï¼Œ$C^i = C^{i-1} + W^i$ï¼Œ$i = 1, \ldots, N$
2. ç”Ÿæˆå•ä¸ªå‡åŒ€éšæœºæ•°ï¼š$U \sim \text{Uniform}[0, 1/N]$
3. è®¾ç½®é‡‡æ ·ç‚¹ï¼š$U^i = U + (i-1)/N$ï¼Œ$i = 1, \ldots, N$
4. å¯¹æ¯ä¸ª $i$ï¼Œæ‰¾åˆ°æœ€å°çš„ $j$ ä½¿å¾— $C^j \geq U^i$ï¼Œè®¾ $A^i = j$

è¾“å‡ºï¼šç¥–å…ˆç´¢å¼• $\{A^i\}_{i=1}^N$

**å®šç† 4.3ï¼ˆç³»ç»Ÿé‡é‡‡æ ·çš„æ–¹å·®ç¼©å‡ï¼‰** è®¾ $N^j$ ä¸ºç²’å­ $j$ è¢«é€‰ä¸­çš„æ¬¡æ•°ã€‚å¯¹äºç³»ç»Ÿé‡é‡‡æ ·ï¼š

$$\text{Var}(N^j) \leq N W^j (1 - W^j) - W^j (1 - W^j)$$

ç›¸æ¯”å¤šé¡¹å¼é‡é‡‡æ ·çš„æ–¹å·® $N W^j (1 - W^j)$ ä¸¥æ ¼æ›´å°ã€‚

---

## äº”ã€è¾…åŠ©ç²’å­æ»¤æ³¢çš„ä¸¥æ ¼æ•°å­¦æ¨å¯¼

### 5.1 è¾…åŠ©å˜é‡çš„å¼•å…¥ä¸è”åˆåˆ†å¸ƒ

**æ ¸å¿ƒæ€æƒ³ï¼š** APFåœ¨æ ‡å‡†ç²’å­æ»¤æ³¢åŸºç¡€ä¸Šå¼•å…¥ç¦»æ•£è¾…åŠ©å˜é‡ $K \in \{1, \ldots, N\}$ï¼Œå°†æ»¤æ³¢é—®é¢˜æå‡è‡³æ›´é«˜ç»´ç©ºé—´ã€‚

**å®šä¹‰ 5.1ï¼ˆæ‰©å±•ç›®æ ‡åˆ†å¸ƒï¼‰** è®¾æ—¶åˆ» $t$ çš„ç²’å­è¿‘ä¼¼ä¸ºï¼š

$$\hat{\pi}_t(x_t) = \sum_{k=1}^N w_t^k \delta_{x_t^k}(x_t), \quad \sum_{k=1}^N w_t^k = 1$$

å®šä¹‰æ—¶åˆ» $t+1$ çš„è”åˆç›®æ ‡åˆ†å¸ƒï¼š

$$p(x_{t+1}, k | y_{1:t+1}) \propto g(y_{t+1} | x_{t+1}) \, f(x_{t+1} | x_t^k) \, w_t^k$$

**å®šç† 5.1ï¼ˆè¾¹ç¼˜åŒ–æ¢å¤æ»¤æ³¢åˆ†å¸ƒï¼‰** å¯¹ $k$ æ±‚å’Œå¾—åˆ°ï¼š

$$p(x_{t+1} | y_{1:t+1}) = \sum_{k=1}^N p(x_{t+1}, k | y_{1:t+1})$$

**è¯æ˜ï¼š** ç”±è”åˆåˆ†å¸ƒå®šä¹‰ï¼š

$$\begin{aligned}
\sum_{k=1}^N p(x_{t+1}, k | y_{1:t+1}) &\propto \sum_{k=1}^N g(y_{t+1} | x_{t+1}) \, f(x_{t+1} | x_t^k) \, w_t^k \\
&= g(y_{t+1} | x_{t+1}) \sum_{k=1}^N f(x_{t+1} | x_t^k) \, w_t^k \\
&\approx g(y_{t+1} | x_{t+1}) \int f(x_{t+1} | x_t) \, d\hat{\Pi}_t(x_t) \\
&\approx g(y_{t+1} | x_{t+1}) \, \pi_{t+1|t}(x_{t+1}) \\
&\propto \pi_{t+1}(x_{t+1})
\end{aligned}$$

å› æ­¤ï¼Œä»è”åˆåˆ†å¸ƒé‡‡æ ·åä¸¢å¼ƒ $k$ï¼Œå³å¯å¾—åˆ°æ»¤æ³¢åˆ†å¸ƒçš„æ ·æœ¬ã€‚ $\square$

### 5.2 æè®®åˆ†å¸ƒçš„æ„é€ 

**å®šä¹‰ 5.2ï¼ˆAPFæè®®åˆ†å¸ƒï¼‰** æ„é€ æè®®åˆ†å¸ƒï¼š

$$q(x_{t+1}, k | y_{1:t+1}) = q(k | y_{1:t+1}) \cdot q(x_{t+1} | k, y_{1:t+1})$$

Pittä¸Shephardæå‡ºçš„æ ‡å‡†é€‰æ‹©ä¸ºï¼š

$$q(x_{t+1}, k | y_{1:t+1}) \propto g(y_{t+1} | \mu_{t+1}^k) \, f(x_{t+1} | x_t^k) \, w_t^k$$

å…¶ä¸­ $\mu_{t+1}^k$ ä¸ºè½¬ç§»åˆ†å¸ƒ $f(\cdot | x_t^k)$ çš„**ç‰¹å¾å€¼**ã€‚

**å®šä¹‰ 5.3ï¼ˆç‰¹å¾å€¼ï¼‰** ç‰¹å¾å€¼ $\mu_{t+1}^k$ é€šå¸¸é€‰å–ä¸ºï¼š

**å‡å€¼ï¼š** $\mu_{t+1}^k = \mathbb{E}[X_{t+1} | X_t = x_t^k] = \int x \, f(x | x_t^k) \, dx$

**ä¼—æ•°ï¼š** $\mu_{t+1}^k = \arg\max_x f(x | x_t^k)$

**ä¸­ä½æ•°æˆ–å…¶ä»–ä½ç½®ç»Ÿè®¡é‡**

### 5.3 æè®®åˆ†å¸ƒçš„åˆ†è§£ä¸é‡‡æ ·

**å®šç† 5.2ï¼ˆæè®®åˆ†å¸ƒçš„åˆ†è§£ï¼‰** APFæè®®åˆ†å¸ƒå¯åˆ†è§£ä¸ºï¼š

$$q(x_{t+1}, k | y_{1:t+1}) = q(k | y_{1:t+1}) \cdot q(x_{t+1} | k)$$

å…¶ä¸­ï¼š

**ç¬¬ä¸€é˜¶æ®µï¼ˆç´¢å¼•é€‰æ‹©ï¼‰ï¼š**

$$q(k | y_{1:t+1}) = \frac{g(y_{t+1} | \mu_{t+1}^k) \, w_t^k \cdot \int f(x_{t+1} | x_t^k) dx_{t+1}}{\sum_{j=1}^N g(y_{t+1} | \mu_{t+1}^j) \, w_t^j} = \frac{g(y_{t+1} | \mu_{t+1}^k) \, w_t^k}{\sum_{j=1}^N g(y_{t+1} | \mu_{t+1}^j) \, w_t^j}$$

**ç¬¬äºŒé˜¶æ®µï¼ˆçŠ¶æ€é‡‡æ ·ï¼‰ï¼š**

$$q(x_{t+1} | k) = f(x_{t+1} | x_t^k)$$

**è¯æ˜ï¼š** å¯¹æè®®åˆ†å¸ƒå…³äº $x_{t+1}$ ç§¯åˆ†ï¼š

$$\begin{aligned}
q(k | y_{1:t+1}) &= \int q(x_{t+1}, k | y_{1:t+1}) \, dx_{t+1} \\
&\propto g(y_{t+1} | \mu_{t+1}^k) \, w_t^k \int f(x_{t+1} | x_t^k) \, dx_{t+1} \\
&= g(y_{t+1} | \mu_{t+1}^k) \, w_t^k
\end{aligned}$$

æ³¨æ„ $g(y_{t+1} | \mu_{t+1}^k)$ ä¸ä¾èµ–äº $x_{t+1}$ï¼Œå¯æè‡³ç§¯åˆ†å¤–ï¼Œè€Œ $\int f(x_{t+1} | x_t^k) dx_{t+1} = 1$ã€‚ $\square$

### 5.4 ç¬¬ä¸€é˜¶æ®µæƒé‡çš„å®šä¹‰ä¸è§£é‡Š

**å®šä¹‰ 5.4ï¼ˆç¬¬ä¸€é˜¶æ®µæƒé‡ï¼‰** å®šä¹‰éå½’ä¸€åŒ–ç¬¬ä¸€é˜¶æ®µæƒé‡ï¼š

$$\tilde{\lambda}_k := g(y_{t+1} | \mu_{t+1}^k) \, w_t^k$$

å½’ä¸€åŒ–ç¬¬ä¸€é˜¶æ®µæƒé‡ï¼š

$$\lambda_k := \frac{\tilde{\lambda}_k}{\sum_{j=1}^N \tilde{\lambda}_j} = \frac{g(y_{t+1} | \mu_{t+1}^k) \, w_t^k}{\sum_{j=1}^N g(y_{t+1} | \mu_{t+1}^j) \, w_t^j}$$

**ç‰©ç†è§£é‡Šï¼š** $\lambda_k$ åæ˜ ç²’å­ $x_t^k$ çš„"é€‚åº”åº¦"â€”â€”ç»¼åˆè€ƒè™‘å…¶å½“å‰æƒé‡ $w_t^k$ ä¸é¢„æµ‹çŠ¶æ€å¯¹æ–°è§‚æµ‹çš„å…¼å®¹æ€§ $g(y_{t+1} | \mu_{t+1}^k)$ã€‚

### 5.5 é‡è¦æ€§æƒé‡çš„ä¸¥æ ¼æ¨å¯¼

**å®šç† 5.3ï¼ˆAPFé‡è¦æ€§æƒé‡ï¼‰** ä»æè®®åˆ†å¸ƒ $q(x_{t+1}, k | y_{1:t+1})$ é‡‡æ ·å¾—åˆ° $(x_{t+1}^r, k^r)$ï¼Œ$r = 1, \ldots, R$ï¼Œåˆ™é‡è¦æ€§æƒé‡ä¸ºï¼š

$$w^r = \frac{p(x_{t+1}^r, k^r | y_{1:t+1})}{q(x_{t+1}^r, k^r | y_{1:t+1})}$$

**å®Œæ•´æ¨å¯¼ï¼š**

åˆ†å­ï¼ˆç›®æ ‡åˆ†å¸ƒï¼‰ï¼š
$$p(x_{t+1}^r, k^r | y_{1:t+1}) \propto g(y_{t+1} | x_{t+1}^r) \, f(x_{t+1}^r | x_t^{k^r}) \, w_t^{k^r}$$

åˆ†æ¯ï¼ˆæè®®åˆ†å¸ƒï¼‰ï¼š
$$q(x_{t+1}^r, k^r | y_{1:t+1}) \propto g(y_{t+1} | \mu_{t+1}^{k^r}) \, f(x_{t+1}^r | x_t^{k^r}) \, w_t^{k^r}$$

å–æ¯”å€¼ï¼š

$$\begin{aligned}
w^r &= \frac{g(y_{t+1} | x_{t+1}^r) \, f(x_{t+1}^r | x_t^{k^r}) \, w_t^{k^r}}{g(y_{t+1} | \mu_{t+1}^{k^r}) \, f(x_{t+1}^r | x_t^{k^r}) \, w_t^{k^r}} \\
&= \frac{g(y_{t+1} | x_{t+1}^r)}{g(y_{t+1} | \mu_{t+1}^{k^r})}
\end{aligned}$$

**å…³é”®è§‚å¯Ÿï¼š** è½¬ç§»å¯†åº¦ $f(x_{t+1}^r | x_t^{k^r})$ ä¸å‰ä¸€æ—¶åˆ»æƒé‡ $w_t^{k^r}$ åœ¨åˆ†å­åˆ†æ¯ä¸­ç›¸æ¶ˆï¼Œç¬¬äºŒé˜¶æ®µæƒé‡ä»…ä¸ºä¼¼ç„¶æ¯”ã€‚

### 5.6 ä¸¤é˜¶æ®µé‡‡æ ·çš„ç†è®ºç­‰ä»·æ€§

**å®šç† 5.4ï¼ˆé‡‡æ ·ç­‰ä»·æ€§ï¼‰** ä»¥ä¸‹ä¸¤ç§é‡‡æ ·æ–¹æ¡ˆç­‰ä»·ï¼š

**æ–¹æ¡ˆAï¼ˆè”åˆé‡‡æ ·ï¼‰ï¼š** ç›´æ¥ä» $q(x_{t+1}, k | y_{1:t+1})$ è”åˆé‡‡æ ·

**æ–¹æ¡ˆBï¼ˆä¸¤é˜¶æ®µé‡‡æ ·ï¼‰ï¼š**
1. ä» $q(k | y_{1:t+1}) = \text{Categorical}(\lambda_1, \ldots, \lambda_N)$ é‡‡æ ·ç´¢å¼• $k$
2. ä» $q(x_{t+1} | k) = f(x_{t+1} | x_t^k)$ é‡‡æ ·çŠ¶æ€ $x_{t+1}$

**è¯æ˜ï¼š** ç”±æ¡ä»¶æ¦‚ç‡å®šä¹‰ï¼Œ$q(x_{t+1}, k) = q(k) \cdot q(x_{t+1} | k)$ï¼Œä¸¤é˜¶æ®µé‡‡æ ·æ­£æ˜¯è”åˆåˆ†å¸ƒçš„åˆ†è§£å½¢å¼ã€‚ $\square$

---

## å…­ã€å®Œæ•´APFç®—æ³•ä¸å®ç°ç»†èŠ‚

### 6.1 ç®—æ³•ä¼ªä»£ç 

**ç®—æ³•ï¼ˆè¾…åŠ©ç²’å­æ»¤æ³¢å™¨ï¼‰ï¼š**

**è¾“å…¥ï¼š** åˆå§‹åˆ†å¸ƒ $\mu(x_0)$ï¼Œè½¬ç§»å¯†åº¦ $f$ï¼Œè§‚æµ‹ä¼¼ç„¶ $g$ï¼Œè§‚æµ‹åºåˆ— $\{y_t\}_{t=1}^T$ï¼Œç²’å­æ•° $N$

**åˆå§‹åŒ–ï¼ˆ$t = 0$ï¼‰ï¼š**
- å¯¹ $i = 1, \ldots, N$ï¼šé‡‡æ · $x_0^i \sim \mu(x_0)$
- è®¾ç½®å‡åŒ€æƒé‡ï¼š$w_0^i = 1/N$

**å¯¹æ¯ä¸ªæ—¶åˆ» $t = 1, \ldots, T$ï¼š**

**æ­¥éª¤1ï¼šè®¡ç®—ç‰¹å¾å€¼**
- å¯¹ $k = 1, \ldots, N$ï¼šè®¡ç®— $\mu_t^k = \mathbb{E}[X_t | X_{t-1} = x_{t-1}^k]$ï¼ˆæˆ–å…¶ä»–ç‰¹å¾å€¼ï¼‰

**æ­¥éª¤2ï¼šç¬¬ä¸€é˜¶æ®µåŠ æƒ**
- å¯¹ $k = 1, \ldots, N$ï¼šè®¡ç®— $\tilde{\lambda}_k = g(y_t | \mu_t^k) \cdot w_{t-1}^k$
- å½’ä¸€åŒ–ï¼š$\lambda_k = \tilde{\lambda}_k / \sum_{j=1}^N \tilde{\lambda}_j$

**æ­¥éª¤3ï¼šç´¢å¼•é‡é‡‡æ ·**
- å¯¹ $r = 1, \ldots, N$ï¼šé‡‡æ · $k^r \sim \text{Categorical}(\lambda_1, \ldots, \lambda_N)$

**æ­¥éª¤4ï¼šçŠ¶æ€ä¼ æ’­**
- å¯¹ $r = 1, \ldots, N$ï¼šé‡‡æ · $x_t^r \sim f(\cdot | x_{t-1}^{k^r})$

**æ­¥éª¤5ï¼šç¬¬äºŒé˜¶æ®µåŠ æƒ**
- å¯¹ $r = 1, \ldots, N$ï¼šè®¡ç®— $\tilde{w}_t^r = g(y_t | x_t^r) / g(y_t | \mu_t^{k^r})$
- å½’ä¸€åŒ–ï¼š$w_t^r = \tilde{w}_t^r / \sum_{j=1}^N \tilde{w}_t^j$

**æ­¥éª¤6ï¼ˆå¯é€‰ï¼‰ï¼šè‡ªé€‚åº”é‡é‡‡æ ·**
- è®¡ç®— $N_{\text{eff}} = 1 / \sum_{r=1}^N (w_t^r)^2$
- è‹¥ $N_{\text{eff}} < N/2$ï¼šæ‰§è¡Œé‡é‡‡æ ·ï¼Œé‡ç½® $w_t^r = 1/N$

**è¾“å‡ºï¼š** åŠ æƒç²’å­é›† $\{(x_t^r, w_t^r)\}_{r=1}^N$ï¼Œ$t = 1, \ldots, T$

### 6.2 è¾¹ç¼˜ä¼¼ç„¶ä¼°è®¡

**å®šç† 6.1ï¼ˆè¾¹ç¼˜ä¼¼ç„¶çš„æ— åä¼°è®¡ï¼‰** APFæä¾›è¾¹ç¼˜ä¼¼ç„¶ $p(y_t | y_{1:t-1})$ çš„æ— åä¼°è®¡ï¼š

$$\hat{p}(y_t | y_{1:t-1}) = \left(\frac{1}{N} \sum_{k=1}^N \tilde{\lambda}_k\right) \cdot \left(\frac{1}{N} \sum_{r=1}^N \tilde{w}_t^r\right)$$

æˆ–ç­‰ä»·åœ°ï¼š

$$\hat{p}(y_t | y_{1:t-1}) = \frac{1}{N} \sum_{k=1}^N g(y_t | \mu_t^k) \, w_{t-1}^k \cdot \frac{1}{N} \sum_{r=1}^N \frac{g(y_t | x_t^r)}{g(y_t | \mu_t^{k^r})}$$

---

## ä¸ƒã€ç†è®ºåˆ†æï¼šæ”¶æ•›æ€§ä¸æ–¹å·®

### 7.1 æ¸è¿‘ä¸€è‡´æ€§

**å®šç† 7.1ï¼ˆå¼ºå¤§æ•°å¾‹ï¼‰** è®¾ $\varphi: \mathcal{X} \to \mathbb{R}$ ä¸ºæœ‰ç•Œå¯æµ‹å‡½æ•°ã€‚å¯¹äºAPFä¼°è®¡é‡ï¼š

$$\hat{\varphi}_t^N := \sum_{i=1}^N w_t^i \, \varphi(x_t^i)$$

åœ¨é€‚å½“çš„æ­£åˆ™æ€§æ¡ä»¶ä¸‹ï¼Œå½“ $N \to \infty$ æ—¶ï¼š

$$\hat{\varphi}_t^N \xrightarrow{a.s.} \mathbb{E}_{\pi_t}[\varphi(X_t)] = \int \varphi(x) \, \pi_t(x) \, dx$$

### 7.2 ä¸­å¿ƒæé™å®šç†

**å®šç† 7.2ï¼ˆæ¸è¿‘æ­£æ€æ€§ï¼‰** åœ¨æ­£åˆ™æ€§æ¡ä»¶ä¸‹ï¼ŒAPFä¼°è®¡é‡æ»¡è¶³ä¸­å¿ƒæé™å®šç†ï¼š

$$\sqrt{N}\left(\hat{\varphi}_t^N - \mathbb{E}_{\pi_t}[\varphi]\right) \xrightarrow{d} \mathcal{N}(0, \sigma_t^2(\varphi))$$

å…¶ä¸­æ¸è¿‘æ–¹å·® $\sigma_t^2(\varphi)$ ä¾èµ–äºé‡é‡‡æ ·æ–¹æ¡ˆä¸æè®®åˆ†å¸ƒçš„é€‰æ‹©ã€‚

### 7.3 Johansen-Doucetçš„ä¿®æ­£åˆ†å¸ƒè§†è§’

**å®šç† 7.3ï¼ˆAPFçš„ä¿®æ­£ç›®æ ‡åˆ†å¸ƒï¼‰** Johansenä¸Doucetï¼ˆ2008ï¼‰è¯æ˜APFå¯è§£é‡Šä¸ºé’ˆå¯¹ä»¥ä¸‹ä¿®æ­£åˆ†å¸ƒçš„æ ‡å‡†SISRç®—æ³•ï¼š

$$\tilde{\pi}_t(x_{1:t}) \propto p(x_{1:t} | y_{1:t}) \cdot \hat{p}(y_{t+1} | x_t)$$

å…¶ä¸­ $\hat{p}(y_{t+1} | x_t) = g(y_{t+1} | \mu_{t+1}(x_t))$ ä¸ºè¿‘ä¼¼é¢„æµ‹ä¼¼ç„¶ã€‚

**é‡è¦æ¨è®ºï¼š** 

1. APFç›®æ ‡ä¸æ ‡å‡†æ»¤æ³¢ç›®æ ‡ $p(x_{1:t} | y_{1:t})$ å­˜åœ¨å·®å¼‚
2. "å®Œç¾è‡ªé€‚åº”"ï¼ˆä½¿ç”¨ç²¾ç¡®é¢„æµ‹ä¼¼ç„¶ï¼‰ä¸èƒ½ä¿è¯æ–¹å·®é™ä½
3. å¯¹äºæŸäº›æ£€éªŒå‡½æ•°ï¼ŒAPFæ¸è¿‘æ–¹å·®å¯èƒ½é«˜äºæ ‡å‡†SIR

### 7.4 æƒé‡æœ‰ç•Œæ€§æ¡ä»¶

**å‘½é¢˜ 7.1ï¼ˆæƒé‡æœ‰ç•Œæ€§ï¼‰** ä¸ºä¿è¯APFä¼°è®¡é‡çš„æœ‰é™æ–¹å·®ï¼Œéœ€æ»¡è¶³ï¼š

$$\sup_{x_{t+1}} \frac{g(y_{t+1} | x_{t+1})}{g(y_{t+1} | \mu_{t+1}^k)} < \infty$$

**æ³¨è®°ï¼š** å½“ä½¿ç”¨ä¼—æ•°ä½œä¸º $\mu_{t+1}^k$ æ—¶ï¼Œè‹¥ä¼¼ç„¶å‡½æ•°åœ¨ä¼—æ•°å¤„å–å¾—æœ€å¤§å€¼ï¼Œåˆ™ä¸Šè¿°æ¡ä»¶è‡ªåŠ¨æ»¡è¶³ã€‚ä½¿ç”¨å‡å€¼æ—¶éœ€é¢å¤–éªŒè¯ã€‚

---

## å…«ã€APFé€‚ç”¨æ€§åˆ†æ

### 8.1 APFä¼˜åŠ¿æ¡ä»¶çš„æ•°å­¦åˆ»ç”»

**å®šç† 8.1ï¼ˆæ•ˆç‡æå‡æ¡ä»¶ï¼‰** è®°æ ‡å‡†SIRæƒé‡æ–¹å·®ä¸º $\text{Var}_{\text{SIR}}$ï¼ŒAPFæƒé‡æ–¹å·®ä¸º $\text{Var}_{\text{APF}}$ã€‚APFä¼˜äºSIRå½“ä¸”ä»…å½“ï¼š

$$\text{Var}_{\text{APF}} < \text{Var}_{\text{SIR}}$$

Pittä¸Shephardç»™å‡ºçš„å……åˆ†æ¡ä»¶ä¸ºï¼š

$$\sum_{k=1}^N \lambda_k \, \mathbb{E}\left[\left(\frac{g(y_{t+1}|X_{t+1})}{g(y_{t+1}|\mu_{t+1}^k)}\right)^2 \Big| K = k\right] < N \sum_{k=1}^N \lambda_k^2 \, \mathbb{E}\left[\left(\frac{g(y_{t+1}|X_{t+1})}{g(y_{t+1}|\mu_{t+1}^k)}\right)^2 \Big| K = k\right]$$

### 8.2 è®¡ç®—å¤æ‚åº¦åˆ†æ

**å‘½é¢˜ 8.1ï¼ˆè®¡ç®—å¤æ‚åº¦ï¼‰** è®¾ä¼¼ç„¶è¯„ä¼°å¤æ‚åº¦ä¸º $O(C_g)$ï¼Œè½¬ç§»é‡‡æ ·å¤æ‚åº¦ä¸º $O(C_f)$ï¼Œç‰¹å¾å€¼è®¡ç®—å¤æ‚åº¦ä¸º $O(C_\mu)$ã€‚åˆ™ï¼š

**æ ‡å‡†SIRï¼š** $O(N \cdot (C_f + C_g))$ æ¯æ—¶é—´æ­¥

**APFï¼š** $O(N \cdot (C_\mu + 2C_g + C_f))$ æ¯æ—¶é—´æ­¥

APFçš„é¢å¤–å¼€é”€ä¸ºç‰¹å¾å€¼è®¡ç®— $O(N \cdot C_\mu)$ ä¸ç¬¬ä¸€é˜¶æ®µä¼¼ç„¶è¯„ä¼° $O(N \cdot C_g)$ã€‚

---

## ä¹ã€ç°ä»£æ‰©å±•çš„æ•°å­¦æ¡†æ¶

### 9.1 ä¼˜åŒ–è¾…åŠ©ç²’å­æ»¤æ³¢ï¼ˆOAPFï¼‰

**å®šä¹‰ 9.1ï¼ˆOAPFç›®æ ‡å‡½æ•°ï¼‰** Branchiniä¸Elviraï¼ˆ2021ï¼‰å°†APFç¬¬ä¸€é˜¶æ®µæƒé‡é€‰æ‹©è¡¨è¿°ä¸ºä¼˜åŒ–é—®é¢˜ï¼š

$$\min_{\boldsymbol{\lambda} \geq 0} \, D_\chi^2\left(\sum_{k=1}^N \lambda_k \, f(\cdot | x_t^k) \, \Big\| \, \pi_{t+1|t}(\cdot)\right)$$

å…¶ä¸­ $D_\chi^2$ ä¸ºå¡æ–¹æ•£åº¦ã€‚

### 9.2 Rao-Blackwellized APF

**å®šä¹‰ 9.2ï¼ˆæ¡ä»¶çº¿æ€§ç»“æ„ï¼‰** è®¾çŠ¶æ€åˆ†è§£ä¸º $x_t = (x_t^{(1)}, x_t^{(2)})$ï¼Œå…¶ä¸­ç»™å®š $x_t^{(1)}$ æ¡ä»¶ä¸‹ï¼Œ$x_t^{(2)}$ æ»¡è¶³çº¿æ€§é«˜æ–¯åŠ¨æ€ã€‚Rao-Blackwellized APFä»…å¯¹ $x_t^{(1)}$ ç»´æŠ¤ç²’å­ï¼Œè€Œ $x_t^{(2)}$ é€šè¿‡Kalmanæ»¤æ³¢è§£æå¤„ç†ã€‚

**å®šç† 9.1ï¼ˆRao-Blackwellæ–¹å·®ç¼©å‡ï¼‰** 

$$\text{Var}\left[\mathbb{E}[\varphi | x^{(1)}]\right] \leq \text{Var}[\varphi]$$

ç­‰å·å½“ä¸”ä»…å½“ $\varphi$ ä»…ä¾èµ–äº $x^{(1)}$ æ—¶æˆç«‹ã€‚

---

## åã€ç»“è®º

è¾…åŠ©ç²’å­æ»¤æ³¢é€šè¿‡å¼•å…¥è¾…åŠ©ç´¢å¼•å˜é‡ï¼Œå®ç°äº†è§‚æµ‹ä¿¡æ¯çš„å‰ç»æ€§åˆ©ç”¨ã€‚æœ¬æ–‡è¯¦ç»†æ¨å¯¼äº†APFçš„æ•°å­¦åŸºç¡€ï¼ŒåŒ…æ‹¬è”åˆç›®æ ‡åˆ†å¸ƒçš„æ„é€ ã€ä¸¤é˜¶æ®µé‡‡æ ·çš„ç†è®ºç­‰ä»·æ€§ã€é‡è¦æ€§æƒé‡çš„ä¸¥æ ¼æ¨å¯¼ï¼Œä»¥åŠæ”¶æ•›æ€§ä¸æ–¹å·®åˆ†æã€‚

æ ¸å¿ƒæ•°å­¦ç»“è®ºï¼š

1. **è”åˆåˆ†å¸ƒè¾¹ç¼˜åŒ–**ï¼š$\sum_k p(x_{t+1}, k | y_{1:t+1}) \propto \pi_{t+1}(x_{t+1})$ï¼Œç¡®ä¿APFæ­£ç¡®æ€§
2. **æƒé‡ç®€åŒ–**ï¼šç”±äºæè®®åˆ†å¸ƒè®¾è®¡ï¼Œç¬¬äºŒé˜¶æ®µæƒé‡ç®€åŒ–ä¸ºä¼¼ç„¶æ¯” $g(y_{t+1}|x_{t+1})/g(y_{t+1}|\mu_{t+1}^k)$
3. **ä¿®æ­£ç›®æ ‡åˆ†å¸ƒ**ï¼šJohansen-Doucetåˆ†ææ­ç¤ºAPFå®é™…é’ˆå¯¹åŒ…å«å‰ç»é¡¹çš„ä¿®æ­£åˆ†å¸ƒ
4. **æ•ˆç‡æ¡ä»¶**ï¼šAPFä¼˜åŠ¿å–å†³äºç¬¬ä¸€é˜¶æ®µæƒé‡çš„æ–¹å·®ç‰¹æ€§ä¸ç‰¹å¾å€¼é¢„æµ‹è´¨é‡

ç†è§£è¿™äº›æ•°å­¦ç»†èŠ‚å¯¹äºæ­£ç¡®å®ç°APFç®—æ³•ã€è¯Šæ–­æ€§èƒ½é—®é¢˜ã€ä»¥åŠå¼€å‘æ”¹è¿›å˜ä½“è‡³å…³é‡è¦ã€‚

---

## å‚è€ƒæ–‡çŒ®

1. Pitt, M. K., & Shephard, N. (1999). Filtering via simulation: Auxiliary particle filters. *Journal of the American Statistical Association*, 94(446), 590-599.

2. Gordon, N. J., Salmond, D. J., & Smith, A. F. (1993). Novel approach to nonlinear/non-Gaussian Bayesian state estimation. *IEE Proceedings F*, 140(2), 107-113.

3. Johansen, A. M., & Doucet, A. (2008). A note on auxiliary particle filters. *Statistics & Probability Letters*, 78(12), 1498-1504.

4. Doucet, A., de Freitas, N., & Gordon, N. (Eds.). (2001). *Sequential Monte Carlo Methods in Practice*. Springer.

5. CappÃ©, O., Moulines, E., & RydÃ©n, T. (2005). *Inference in Hidden Markov Models*. Springer.

6. Del Moral, P. (2004). *Feynman-Kac Formulae: Genealogical and Interacting Particle Systems with Applications*. Springer.

7. Chopin, N., & Papaspiliopoulos, O. (2020). *An Introduction to Sequential Monte Carlo*. Springer.

8. Branchini, N., & Elvira, V. (2021). Optimized auxiliary particle filters. *Proceedings of UAI*, 1289-1299.
